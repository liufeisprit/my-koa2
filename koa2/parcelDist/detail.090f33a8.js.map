{"version":3,"sources":["views/movie/detail.js"],"names":["site","DPlayer","window","TabPane","Tabs","moment","locale","callback","key","console","log","MovieDetail","Component","constructor","props","_getMovieDetail","method","url","state","_id","then","data","movie","relativeMovies","video","videoKey","pic","coverKey","setState","player","container","document","getElementById","screenshot","thumbnails","catch","loading","match","params","id","componentDidMount","componentWillReceiveProps","nextProps","render","title","rate","backgroundColor","tags","join","meta","createdAt","fromNow","summary","map","item","posterKey","rawTitle","pubdate","it","i","date","format","country"],"mappings":"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","file":"detail.090f33a8.js","sourceRoot":"..\\src","sourcesContent":["import React , {Component} from 'react'\r\nimport {request} from '../../lib'\r\nimport { Tabs, Card, Badge, Radio, Button, message, List, Avatar } from 'antd'\r\nimport { Link } from 'react-router-dom'\r\nimport moment from 'moment'\r\nconst site = 'http://puzvb5scj.bkt.clouddn.com/'\r\nconst DPlayer = window.DPlayer\r\nconst TabPane = Tabs.TabPane\r\nimport 'moment/locale/zh-cn'\r\nmoment.locale('zh-cn')\r\nfunction callback(key) {\r\n  console.log(key);\r\n}\r\nexport default class MovieDetail extends Component{\r\n    constructor(props){\r\n        super(props)\r\n        this.state={\r\n            loading: false,\r\n            relativeMovies: [],\r\n            _id: this.props.match.params.id,\r\n            movie: null,\r\n            player:null\r\n        }\r\n    }\r\n    componentDidMount(){\r\n      this._getMovieDetail()\r\n    }\r\n    componentWillReceiveProps(nextProps) {\r\n        if(nextProps.match.params.id!==this.props.match.params.id){\r\n          this.setState({\r\n            _id:nextProps.match.params.id\r\n        },this._getMovieDetail)\r\n      }\r\n    }\r\n    _getMovieDetail=()=>{\r\n        request({\r\n          method: 'get',\r\n          url: `/v0/api/movies/${this.state._id}`\r\n        })\r\n        .then(data => {\r\n          const {movie,relativeMovies} = data\r\n          const video = site + movie.videoKey\r\n          const pic = site + movie.coverKey\r\n          console.log('_getMovieDetail')\r\n          this.setState({\r\n            movie,\r\n            relativeMovies,\r\n          }, () => {\r\n            this.player = new DPlayer({\r\n              container: document.getElementById('videoPlayer'),\r\n              screenshot: true,\r\n              video: {\r\n                url: video,\r\n                pic: pic,\r\n                thumbnails: pic\r\n              }\r\n            })\r\n          })\r\n        })\r\n        .catch(() => {\r\n          console.log('catch')\r\n        //   this.props.history.goBack()\r\n        })\r\n      }\r\n    render(){\r\n        const {movie,relativeMovies}=this.state\r\n        if (!movie) return null;\r\n        return(\r\n            <div className='flex-row full'>\r\n                <div className=\"page-shade\">\r\n                    <div className=\"video-wrapper\">\r\n                        <div id=\"videoPlayer\" src={site + movie.coverKey} data-video={site + movie.videoKey} />\r\n                    </div>\r\n                    <div className=\"video-sidebar\">\r\n                        <Link className='homeLink' to={'/'}>回到首页</Link>\r\n                        <Tabs defaultActiveKey=\"1\" onChange={callback}>\r\n                        <TabPane tab=\"关于本片\" key=\"1\">\r\n                            <h1>{movie.title}</h1>\r\n                            <dl>\r\n                            <dt>豆瓣评分：<Badge count={movie.rate} style={{ backgroundColor: '#52c41a' }} /> 分</dt>\r\n                            <dt>电影分类：{movie.tags && movie.tags.join(' ')}</dt>\r\n                            <dt>更新时间：{moment(movie.meta.createdAt).fromNow()}</dt>\r\n                            <dt>影片介绍：</dt>\r\n                            <dd>{movie.summary}</dd>\r\n                            </dl>\r\n                        </TabPane>\r\n                        <TabPane tab=\"同类电影\" key=\"2\">\r\n                            {\r\n                            relativeMovies.map(item => (\r\n                                <Link key={item._id} className=\"media\" to={`/detail/${item._id}`}>\r\n                                <img width=\"60\" className=\"align-self-center mr-3\" src={site + item.posterKey} alt={item.rawTitle} />\r\n                                <div className=\"media-body\">\r\n                                    <h6 className=\"media-title\">{item.title}</h6>\r\n                                    <ul className=\"list-unstyled\">\r\n                                    {\r\n                                        item.pubdate && item.pubdate.map((it, i) => (\r\n                                        <li key={i}>{moment(it.date).format('YYYY.MM')} ({it.country})</li>\r\n                                        ))\r\n                                    }\r\n                                    </ul>\r\n                                </div>\r\n                                </Link>\r\n                            ))\r\n                            }\r\n                        </TabPane>\r\n                        </Tabs>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n    \r\n}"]}